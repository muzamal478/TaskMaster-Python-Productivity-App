<div class="task-card card mb-3 shadow-sm animate__animated animate__fadeInUp" data-task-id="{{ task.id }}">
  <div class="card-body d-flex gap-3">
    <div class="priority-indicator {{ 'urgent' if task.priority=='Urgent' else ('high' if task.priority=='High' else ('medium' if task.priority=='Medium' else 'low')) }}"></div>

    <div class="flex-grow-1">
      <div class="d-flex justify-content-between align-items-start">
        <div>
          <h5 class="mb-1 fw-semibold {% if task.completed %}text-decoration-line-through text-muted{% endif %}">{{ task.title }}</h5>
          <div class="small text-muted">{{ task.category }} · {{ task.created_at.strftime('%Y-%m-%d') }}</div>
        </div>
        <div class="text-end">
          {% if task.due_date %}
            <div class="small text-warning"><i class="fa-regular fa-clock"></i> {{ task.due_date.strftime('%Y-%m-%d %H:%M') }}</div>
          {% endif %}
          <div class="mt-2">
            <a class="btn btn-sm btn-ghost btn-light me-1" href="{{ url_for('view_task', task_id=task.id) }}" title="View"><i class="fa fa-eye"></i></a>
            <a class="btn btn-sm btn-ghost btn-light me-1" href="{{ url_for('edit_task', task_id=task.id) }}" title="Edit"><i class="fa fa-pen"></i></a>

            <form method="post" action="{{ url_for('delete_task', task_id=task.id) }}" class="d-inline" onsubmit="return confirm('Delete this task?');">
              <button type="submit" class="btn btn-sm btn-danger" title="Delete"><i class="fa fa-trash"></i></button>
            </form>
          </div>
        </div>
      </div>

      <p class="mb-0 mt-2 text-muted small">{{ task.description[:160] }}{% if task.description|length > 160 %}…{% endif %}</p>
    </div>
  </div>
  <div class="card-footer bg-transparent d-flex justify-content-between align-items-center">
    <div class="small text-muted">Priority: <strong>{{ task.priority }}</strong></div>
    <div>
      <form method="post" action="{{ url_for('toggle_complete', task_id=task.id) }}" class="d-inline">
        <button type="submit" class="btn btn-sm btn-outline-success">{{ 'Undo' if task.completed else 'Done' }}</button>
      </form>
    </div>
  </div>
</div>
